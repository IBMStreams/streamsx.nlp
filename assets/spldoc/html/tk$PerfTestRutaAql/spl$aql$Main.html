<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en-us" lang="en-us">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<meta name="copyright" content="(C) Copyright 2005"/>
<meta name="DC.rights.owner" content="(C) Copyright 2005"/>
<meta name="DC.Type" content="reference"/>
<meta name="DC.Title" content="SPL File Main.spl"/>
<meta name="DC.Format" content="XHTML"/>
<meta name="DC.Identifier" content="spldoc_compilationunit"/>
<link rel="stylesheet" type="text/css" href="../../html/commonltr.css"/>
<link rel="stylesheet" type="text/css" href="../../html/spldoc.css"/>
<title>SPL File Main.spl</title>
</head>
<body id="spldoc_compilationunit">


<h1 class="title topictitle1">SPL File <tt class="ph tt">Main.spl</tt></h1>

<div class="body refbody">
<div class="section">
<p class="p">
<a class="xref" href="../toolkits/toolkits.html">Toolkits</a> &gt; <a class="xref" href="tk$PerfTestRutaAql.html">PerfTestRutaAql 1.0.0</a> &gt; <a class="xref" href="ns$aql.html">aql</a> &gt; Main.spl</p>

</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Content</h2>
  
  <dl class="dl">
    <dt class="dt dlterm"/>
<dd class="dd"/>

    
      <dt class="dt dlterm splhead-2">Operators</dt>

      <dd class="dd">
<ul class="sl simple">
<li class="sli"><strong class="ph b"><a class="xref" href="spl$aql$Main.html#spldoc_compilationunit__composite_operator__AqlTextExtract">AqlTextExtract</a></strong>
</li>

<li class="sli"><strong class="ph b"><a class="xref" href="spl$aql$Main.html#spldoc_compilationunit__composite_operator__Main">Main</a></strong>
</li>

</ul>

      </dd>

    
  </dl>

</div>

<div class="section"><h2 class="title sectiontitle splhead-1">Composites</h2>
  
</div>

<div class="section" id="spldoc_compilationunit__composite_operator__Main"><h2 class="title sectiontitle splpart">public composite Main</h2>
  
</div>

<div class="section splgraph">
  <embed class="image" src="../../image/tk$PerfTestRutaAql/op$aql$Main.svg" width="118" height="109"/>
</div>

<div class="section"><h2 class="title sectiontitle">Parameters</h2>

<ul class="sl simple">
<li class="sli"><strong class="ph b">loop</strong>
</li>

</ul>

</div>

<div class="section">
</div>

<div class="section">
</div>

<div class="section"><h2 class="title sectiontitle splhead-2">SPL Source Code</h2>
  
</div>


<div class="section">
   <pre class="pre codeblock">

 @threading(model=manual)
 composite Main
 {
 	param
 		expression&lt;int32&gt;   $loop: (int32)getSubmissionTimeValue("loop", "1");
 	graph
 
 		() as TestAql = PerfTest() {
 			param
 				loop: $loop;
 				textExtract: AqlTextExtract;
 				outputFilename: "aqlSpanWithText.out";
 				resultFilename: "aql_result.out";
 			config placement: partitionColocation("PERFTEST");
 		}
 }

   </pre>

</div>

<div class="section" id="spldoc_compilationunit__composite_operator__AqlTextExtract"><h2 class="title sectiontitle splpart">composite AqlTextExtract(output NamesList; input Documents)</h2>
  
</div>

<div class="section splgraph">
  <embed class="image" src="../../image/tk$PerfTestRutaAql/op$aql$AqlTextExtract.svg" width="248" height="109"/>
</div>

<div class="section">
</div>

<div class="section"><h2 class="title sectiontitle">Input Ports</h2>

<ul class="sl simple">
<li class="sli"><strong class="ph b">Documents</strong>
</li>

</ul>

</div>

<div class="section"><h2 class="title sectiontitle">Output Ports</h2>

<ul class="sl simple">
<li class="sli"><strong class="ph b">NamesList</strong>
</li>

</ul>

</div>

<div class="section"><h2 class="title sectiontitle splhead-2">SPL Source Code</h2>
  
</div>


<div class="section">
   <pre class="pre codeblock">

 public composite AqlTextExtract (
 	input 
 		Documents;
 	output
 		NamesList
 )
 {
 	graph
 		(
 		stream&lt;rstring documentFile, AnnoSpan fullName, rstring title&gt; NamesSpanWithText;
 		stream&lt;I&gt; PassThrough
                 ) = TextExtract(Documents as I) {
  
 			param
 				moduleName : "getNames";
 				modulePath : "etc/modulelib";
 				outputMode : "multiPort";
 				inputDoc : "entireDoc";
 				passThrough: true;
 		}
 
 		stream&lt;rstring documentFile, list&lt;AnnoSpan&gt; annotations, rstring entireDoc&gt; NamesList = Custom(NamesSpanWithText as I; PassThrough as P) {
 			logic
 				state: {
 					mutable list&lt;AnnoSpan&gt; annotations_ = [];
 					mutable rstring documentFile_ = "";
 					mutable rstring entireDoc_ = "";
 					mutable rstring filename = "";
 				}
 				onTuple P: {
 					submit({documentFile=P.documentFile, annotations = annotations_, entireDoc=P.entireDoc}, NamesList);
 					submit(Sys.WindowMarker, NamesList);
 				}
 				onTuple I: {
 					entireDoc_ = I.fullName.text;
 					documentFile_ = I.documentFile;
 					mutable AnnoSpan anno = {};
 					anno.text = title + " " + substring(I.fullName.text, I.fullName.begin, I.fullName.end-I.fullName.begin);
 					anno.begin = I.fullName.begin;
 					anno.end = I.fullName.end;
 					appendM(annotations_, anno);
 				}
 				onPunct I: {
 					//printStringLn("currentPunct()="+(rstring)currentPunct());
 					if (currentPunct() == Sys.WindowMarker) {
 						if ("" != documentFile_) {
 							submit({documentFile=documentFile_, annotations = annotations_, entireDoc=entireDoc_}, NamesList);
 							clearM(annotations_);
 							entireDoc_="";
 							documentFile_="";
 							submit(currentPunct(), NamesList);
 						}
 					}
 					else {
 						submit(currentPunct(), NamesList) ;
 					}
 				}
 		}
 }

   </pre>

</div>

</div>


</body>
</html>